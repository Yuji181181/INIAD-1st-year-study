<!DOCTYPE html>

<html lang="ja" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>クラスベースビュー &#8212; Django 5.1.6.dev20250122212402 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=34bb78ad" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css?v=bf4d74af" />
    <script src="../../_static/documentation_options.js?v=d2885b0a"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=4755f45a"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="クラスベースビュー入門" href="intro.html" />
    <link rel="prev" title="テンプレート" href="../templates.html" />



 
<script src="../../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../../index.html">Django 5.1.6.dev20250122212402 ドキュメント</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../../index.html">Home</a>  |
        <a title="Table of contents" href="../../contents.html">Table of contents</a>  |
        <a title="Global index" href="../../genindex.html">Index</a>  |
        <a title="Module index" href="../../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="../templates.html" title="テンプレート">previous</a>
     |
    <a href="../index.html" title="Django を使う" accesskey="U">up</a>
   |
    <a href="intro.html" title="クラスベースビュー入門">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="topics-class-based-views-index">
            
  <section id="s-class-based-views">
<span id="class-based-views"></span><h1>クラスベースビュー<a class="headerlink" href="#class-based-views" title="Link to this heading">¶</a></h1>
<p>ビューとは、リクエストを受け取り、レスポンスを返す呼び出し可能オブジェクトです。ビューは単なる関数以上のものにもなり得ます。Django ではビューとして使用できるいくつかのクラスを提供しており、これらを利用することで、ビューを構造化し、継承やミックスインを活用してコードを再利用できます。また、汎用ビュー（generic view）も用意されていますが、それについては後ほど説明します。あなたのユースケースに合った再利用可能なビューの構造を設計することもできます。詳細については、<a class="reference internal" href="../../ref/class-based-views/index.html"><span class="doc">クラスベースビューのリファレンスドキュメント</span></a> を参照してください。</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">クラスベースビュー入門</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-display.html">組み込みのクラスベースのジェネリックビュー（汎用ビュー）</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-editing.html">クラスベースのビューでフォームを扱う</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixins.html">クラスベースのビューでミックスイン (mixin) を使用する</a></li>
</ul>
</div>
<section id="s-basic-examples">
<span id="basic-examples"></span><h2>基本的な例<a class="headerlink" href="#basic-examples" title="Link to this heading">¶</a></h2>
<p>Django は、さまざまなアプリケーションに広く適用できるベースビュークラスを用意しています。 <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.View" title="django.views.generic.base.View"><code class="xref py py-class docutils literal notranslate"><span class="pre">View</span></code></a> クラスを継承したすべてのビューは、指定した URL へのビューのリンクや、送り出す HTTP メソッド、その他よく使われる機能をハンドリングします。 <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.RedirectView" title="django.views.generic.base.RedirectView"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedirectView</span></code></a> は HTTP リダイレクトを行うビュークラス、 <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.TemplateView" title="django.views.generic.base.TemplateView"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemplateView</span></code></a> はベースビューを拡張してテンプレートレンダリングの機能をもたせたビュークラスです。</p>
</section>
<section id="s-usage-in-your-urlconf">
<span id="usage-in-your-urlconf"></span><h2>URLconfでの使用法<a class="headerlink" href="#usage-in-your-urlconf" title="Link to this heading">¶</a></h2>
<p>ジェネリックビューを使用する最もダイレクトな方法は、URLconf 内で直接オブジェクトを作成することです。クラスベースビューの属性をいくつか変更するだけなら、 <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.View.as_view" title="django.views.generic.base.View.as_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_view()</span></code></a> のメソッド呼び出しに渡せばよいのです。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.views.generic</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemplateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;about/&quot;</span><span class="p">,</span> <span class="n">TemplateView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s2">&quot;about.html&quot;</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>
</div>
<p><a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.View.as_view" title="django.views.generic.base.View.as_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_view()</span></code></a> に渡されたすべての引数は、クラスで設定された属性を上書きします。次の例では <code class="docutils literal notranslate"><span class="pre">TemplateView</span></code> の <code class="docutils literal notranslate"><span class="pre">template_name</span></code> を設定しています。同様の上書きのパターンは、<a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.RedirectView" title="django.views.generic.base.RedirectView"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedirectView</span></code></a> の <code class="docutils literal notranslate"><span class="pre">url</span></code> 属性でも使えます。</p>
</section>
<section id="s-subclassing-generic-views">
<span id="subclassing-generic-views"></span><h2>ジェネリックビューのサブクラス化<a class="headerlink" href="#subclassing-generic-views" title="Link to this heading">¶</a></h2>
<p>次に、ジェネリックビューのもっと強力な使用例として、既存のビューを継承して、新しい値やメソッドを提供するために、 <code class="docutils literal notranslate"><span class="pre">template_name</span></code> などの属性や <code class="docutils literal notranslate"><span class="pre">get_context_data</span></code> などのメソッドをサブクラスで上書きする方法を紹介します。たとえば、1つのテンプレート <code class="docutils literal notranslate"><span class="pre">about.html</span></code> だけを表示するビューを作ることを考えてみてください。Django には、このために利用できるジェネリックビュー <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.TemplateView" title="django.views.generic.base.TemplateView"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemplateView</span></code></a> があるので、これをサブクラス化し、テンプレート名を上書きすることで実装できます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># some_app/views.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.views.generic</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemplateView</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AboutView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s2">&quot;about.html&quot;</span>
</pre></div>
</div>
<p>あとは、URLconf にこの新しいビューを追加する必要があります。 <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.TemplateView" title="django.views.generic.base.TemplateView"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemplateView</span></code></a> は1つのクラスであって、関数ではありません。そのため、指定する URL に対して、代わりに <a class="reference internal" href="../../ref/class-based-views/base.html#django.views.generic.base.View.as_view" title="django.views.generic.base.View.as_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_view()</span></code></a> クラスメソッドを設定しています。これによって、クラスベースビューに対する関数ライクな要素を指定できます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># urls.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">some_app.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">AboutView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;about/&quot;</span><span class="p">,</span> <span class="n">AboutView</span><span class="o">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>組み込みの汎用ビューの使用方法の詳細については、次のトピック <a class="reference internal" href="generic-display.html"><span class="doc">汎用のクラスベースビュー</span></a> を参照してください。</p>
<section id="s-supporting-other-http-methods">
<span id="s-id1"></span><span id="supporting-other-http-methods"></span><span id="id1"></span><h3>その他の HTTP メソッドをサポートする<a class="headerlink" href="#supporting-other-http-methods" title="Link to this heading">¶</a></h3>
<p>誰かが私たちのライブラリに HTTP 経由でアクセスして、ビューを API として使用したいという状況を考えてください。API クライアントはたびたびコネクションを張り、最終訪問日時以降に出版された本のデータをダウンロードするとします。しかし、新しい本の情報が存在しない場合には、データベースから本のデータを取得し、レスポンステキストをレンダリングし、クライアントに送信し返すための CPU タイムとバンド幅は無駄になってしまいます。最新の本が出版された時点で API に問い合わせた方が好ましいかもしれません。</p>
<p>そのために、URLconf 内で、本のリストビューへの URL を次のようにマッピングします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">books.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">BookListView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;books/&quot;</span><span class="p">,</span> <span class="n">BookListView</span><span class="o">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>そして、ビューには次のように書きます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.views.generic</span><span class="w"> </span><span class="kn">import</span> <span class="n">ListView</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">books.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Book</span>


<span class="k">class</span><span class="w"> </span><span class="nc">BookListView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Book</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">last_book</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">latest</span><span class="p">(</span><span class="s2">&quot;publication_date&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span>
            <span class="c1"># RFC 1123 date format.</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;Last-Modified&quot;</span><span class="p">:</span> <span class="n">last_book</span><span class="o">.</span><span class="n">publication_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">%a</span><span class="s2">, </span><span class="si">%d</span><span class="s2"> %b %Y %H:%M:%S GMT&quot;</span>
                <span class="p">)</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<p>ビューが <code class="docutils literal notranslate"><span class="pre">GET</span></code> リクエストからアクセスされた場合、レスポンスにはオブジェクトリストが返されます( <code class="docutils literal notranslate"><span class="pre">book_list.html</span></code> テンプレートを使用しています)。しかし、クライアントがHEADリクエストを発行した場合、レスポンスは空のボディを持ち、 <code class="docutils literal notranslate"><span class="pre">Last-Modified</span></code> ヘッダーは最新の書籍がいつ発行されたかを示します。この情報に基づいて、クライアントは完全なオブジェクトリストをダウンロードするかどうかを判断します。</p>
</section>
</section>
<section id="s-asynchronous-class-based-views">
<span id="s-async-class-based-views"></span><span id="asynchronous-class-based-views"></span><span id="async-class-based-views"></span><h2>非同期のクラスベース・ビュー<a class="headerlink" href="#asynchronous-class-based-views" title="Link to this heading">¶</a></h2>
<p>既に示した同期 (<code class="docutils literal notranslate"><span class="pre">def</span></code>) メソッドハンドラと同様に、 <code class="docutils literal notranslate"><span class="pre">View</span></code> サブクラスは <code class="docutils literal notranslate"><span class="pre">await</span></code>: を使用して非同期 (<code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code>) メソッドハンドラを定義できます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">View</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AsyncView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Perform io-blocking view logic using await, sleep for example.</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;Hello async world!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>1つのビュークラス内では、すべてのユーザー定義メソッドハンドラは <code class="docutils literal notranslate"><span class="pre">def</span></code> を使用した同期的なものか、 <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code> を使用した非同期的なものでなければなりません。 <code class="docutils literal notranslate"><span class="pre">def</span></code> と <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code> が混在している場合、 <code class="docutils literal notranslate"><span class="pre">as_view()</span></code> で <code class="docutils literal notranslate"><span class="pre">ImproperlyConfigured</span></code> 例外が発生します。</p>
<p>Django は自動的に非同期ビューを検出し、非同期コンテキストで実行します。Django の非同期サポートや、非同期ビューの最適な使い方については、 <a class="reference internal" href="../async.html"><span class="doc">非同期サポート</span></a> を参照してください。</p>
</section>
</section>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="#">クラスベースビュー</a><ul>
<li><a class="reference internal" href="#basic-examples">基本的な例</a></li>
<li><a class="reference internal" href="#usage-in-your-urlconf">URLconfでの使用法</a></li>
<li><a class="reference internal" href="#subclassing-generic-views">ジェネリックビューのサブクラス化</a><ul>
<li><a class="reference internal" href="#supporting-other-http-methods">その他の HTTP メソッドをサポートする</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asynchronous-class-based-views">非同期のクラスベース・ビュー</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="../templates.html"
                          title="前の章へ">テンプレート</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="intro.html"
                          title="次の章へ">クラスベースビュー入門</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/topics/class-based-views/index.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">1月 22, 2025</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="../templates.html" title="テンプレート">previous</a>
     |
    <a href="../index.html" title="Django を使う" accesskey="U">up</a>
   |
    <a href="intro.html" title="クラスベースビュー入門">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>