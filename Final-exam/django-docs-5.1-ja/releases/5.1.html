<!DOCTYPE html>

<html lang="ja" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Django 5.1 リリースノート &#8212; Django 5.1.6.dev20250122212402 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=34bb78ad" />
    <link rel="stylesheet" type="text/css" href="../_static/default.css?v=bf4d74af" />
    <script src="../_static/documentation_options.js?v=d2885b0a"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=4755f45a"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="Django 5.0.12 release notes" href="5.0.12.html" />
    <link rel="prev" title="Django 5.1.1 リリースノート" href="5.1.1.html" />



 
<script src="../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../index.html">Django 5.1.6.dev20250122212402 ドキュメント</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../index.html">Home</a>  |
        <a title="Table of contents" href="../contents.html">Table of contents</a>  |
        <a title="Global index" href="../genindex.html">Index</a>  |
        <a title="Module index" href="../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="5.1.1.html" title="Django 5.1.1 リリースノート">previous</a>
     |
    <a href="index.html" title="リリースノート" accesskey="U">up</a>
   |
    <a href="5.0.12.html" title="Django 5.0.12 release notes">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="releases-5.1">
            
  <section id="s-django-5-1-release-notes">
<span id="django-5-1-release-notes"></span><h1>Django 5.1 リリースノート<a class="headerlink" href="#django-5-1-release-notes" title="Link to this heading">¶</a></h1>
<p><em>2024年8月7日</em></p>
<p>Django 5.1 へようこそ！</p>
<p>このリリースノートでは、 <a class="reference internal" href="#whats-new-5-1"><span class="std std-ref">バージョン 5.1 の新機能</span></a> と、Django 5.0 以前からアップグレードする際に注意すべき、 <a class="reference internal" href="#backwards-incompatible-5-1"><span class="std std-ref">後方互換性のない変更</span></a> について説明します。また、 <a class="reference internal" href="5.0.html#deprecated-features-5-0"><span class="std std-ref">一部の機能を非推奨</span></a> としました。</p>
<p>既存のプロジェクトをアップデートするときは、 <a class="reference internal" href="../howto/upgrade-version.html"><span class="doc">Django の新しいバージョンへの更新</span></a> ガイドに従ってください。</p>
<section id="s-python-compatibility">
<span id="python-compatibility"></span><h2>Python バージョン間の互換性<a class="headerlink" href="#python-compatibility" title="Link to this heading">¶</a></h2>
<p>Django 5.1 は、Python 3.10、3.11、3.12、および 3.13（5.1.3 時点）をサポートしています。 <strong>最新のリリース</strong> を使用することを強く推奨しており、公式にサポートするのも各シリーズの最新リリースのみです。</p>
</section>
<section id="s-what-s-new-in-django-5-1">
<span id="s-whats-new-5-1"></span><span id="what-s-new-in-django-5-1"></span><span id="whats-new-5-1"></span><h2>Django 5.1 の新機能<a class="headerlink" href="#what-s-new-in-django-5-1" title="Link to this heading">¶</a></h2>
<section id="s-querystring-template-tag">
<span id="querystring-template-tag"></span><h3><code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">querystring</span> <span class="pre">%}</span></code> テンプレートタグ<a class="headerlink" href="#querystring-template-tag" title="Link to this heading">¶</a></h3>
<p>Django 5.1 では、<a class="reference internal" href="../ref/templates/builtins.html#std-templatetag-querystring"><code class="xref std std-ttag docutils literal notranslate"><span class="pre">{%</span> <span class="pre">querystring</span> <span class="pre">%}</span></code></a> テンプレートタグが導入されました。これにより、URL 内のクエリパラメータの変更が簡略化され、既存のクエリパラメータを維持しつつ、特定の部分を追加または変更してリンクを生成するのが簡単になります。</p>
<p>たとえば、テンプレート内でページネーションやクエリ文字列を操作するのは面倒な場合があります。ページネーションされたビュー内で、次のページに移動するための URL を動的に生成する次のようなテンプレートフラグメントについて考えてみてください。</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="c">{# Linebreaks added for readability, this should be one, long line. #}</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;?</span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">key</span><span class="o">,</span> <span class="nv">values</span> <span class="k">in</span> <span class="nv">request.GET.iterlists</span> <span class="cp">%}</span>
<span class="s">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">key</span> <span class="o">!=</span> <span class="s2">&quot;page&quot;</span> <span class="cp">%}</span>
<span class="s">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">value</span> <span class="k">in</span> <span class="nv">values</span> <span class="cp">%}</span>
<span class="s">      </span><span class="cp">{{</span> <span class="nv">key</span> <span class="cp">}}</span><span class="s">=</span><span class="cp">{{</span> <span class="nv">value</span> <span class="cp">}}</span><span class="s">&amp;amp;</span>
<span class="s">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="s">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="s">page=</span><span class="cp">{{</span> <span class="nv">page.next_page_number</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>Next page<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>これを新しいテンプレートタグを使用するように切り替えると、上記は次のように魔法のように簡略化されます。</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">querystring</span> <span class="nv">page</span><span class="o">=</span><span class="nv">page.next_page_number</span> <span class="cp">%}</span><span class="s">&quot;</span><span class="p">&gt;</span>Next page<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="s-postgresql-connection-pools">
<span id="postgresql-connection-pools"></span><h3>PostgreSQL の接続プール<a class="headerlink" href="#postgresql-connection-pools" title="Link to this heading">¶</a></h3>
<p>Django 5.1 では、PostgreSQL の <a class="reference internal" href="../ref/databases.html#postgresql-pool"><span class="std std-ref">接続プール</span></a> のサポートも導入されました。新しい接続の確立には比較的長い時間がかかる場合があるため、接続をオープンにしたままにしておくことで、レイテンシを削減できます。</p>
<p><a class="reference external" href="https://www.psycopg.org/">psycopg</a> で接続プールを使用するには、次のように <a class="reference internal" href="../ref/settings.html#std-setting-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a> 内の <code class="docutils literal notranslate"><span class="pre">&quot;pool&quot;</span></code> オプションに、<a class="reference external" href="https://www.psycopg.org/psycopg3/docs/api/pool.html#psycopg_pool.ConnectionPool" title="(in psycopg)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPool</span></code></a> に渡されるディクショナリを設定するか、<code class="docutils literal notranslate"><span class="pre">True</span></code> にすることで <code class="docutils literal notranslate"><span class="pre">ConnectionPool</span></code> のデフォルトを使用します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ENGINE&quot;</span><span class="p">:</span> <span class="s2">&quot;django.db.backends.postgresql&quot;</span><span class="p">,</span>
        <span class="c1"># ...</span>
        <span class="s2">&quot;OPTIONS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;pool&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;min_size&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;max_size&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="s-middleware-to-require-authentication-by-default">
<span id="middleware-to-require-authentication-by-default"></span><h3>デフォルトで認証を要求するミドルウェア<a class="headerlink" href="#middleware-to-require-authentication-by-default" title="Link to this heading">¶</a></h3>
<p>新しい <a class="reference internal" href="../ref/middleware.html#django.contrib.auth.middleware.LoginRequiredMiddleware" title="django.contrib.auth.middleware.LoginRequiredMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoginRequiredMiddleware</span></code></a> は、すべての未認証リクエストをログインページにリダイレクトします。新しい <a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.decorators.login_not_required" title="django.contrib.auth.decorators.login_not_required"><code class="xref py py-func docutils literal notranslate"><span class="pre">login_not_required()</span></code></a> デコレータを使用すると、ビューで未認証リクエストを許可できるようになります。</p>
<p><code class="docutils literal notranslate"><span class="pre">LoginRequiredMiddleware</span></code> は、<a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal notranslate"><span class="pre">login_required()</span></code></a> デコレータによって設定された <code class="docutils literal notranslate"><span class="pre">login_url</span></code> と <code class="docutils literal notranslate"><span class="pre">redirect_field_name</span></code> の値を尊重しますが、<a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.mixins.LoginRequiredMixin" title="django.contrib.auth.mixins.LoginRequiredMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoginRequiredMixin</span></code></a> による <code class="docutils literal notranslate"><span class="pre">login_url</span></code> または <code class="docutils literal notranslate"><span class="pre">redirect_field_name</span></code> の設定はサポートされていません。</p>
<p>これを有効にするには、<code class="docutils literal notranslate"><span class="pre">&quot;django.contrib.auth.middleware.LoginRequiredMiddleware&quot;</span></code> を <a class="reference internal" href="../ref/settings.html#std-setting-MIDDLEWARE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MIDDLEWARE</span></code></a> 設定に追加します。</p>
</section>
<section id="s-minor-features">
<span id="minor-features"></span><h3>マイナーな機能<a class="headerlink" href="#minor-features" title="Link to this heading">¶</a></h3>
<section id="s-django-contrib-admin">
<span id="django-contrib-admin"></span><h4><a class="reference internal" href="../ref/contrib/admin/index.html#module-django.contrib.admin" title="django.contrib.admin: Django's admin site."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.admin</span></code></a><a class="headerlink" href="#django-contrib-admin" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/contrib/admin/index.html#django.contrib.admin.ModelAdmin.list_display" title="django.contrib.admin.ModelAdmin.list_display"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelAdmin.list_display</span></code></a> において、関連モデルのフィールドをリスト表示するために <code class="docutils literal notranslate"><span class="pre">__</span></code> 演算子によるルックアップができるようになりました。</p></li>
</ul>
</section>
<section id="s-django-contrib-auth">
<span id="django-contrib-auth"></span><h4><a class="reference internal" href="../topics/auth/index.html#module-django.contrib.auth" title="django.contrib.auth: Django's authentication framework."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.auth</span></code></a><a class="headerlink" href="#django-contrib-auth" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>PBKDF2パスワードハッシャーのデフォルトの繰り返し回数が、720,000から870,000に増加しました。</p></li>
<li><p>OWASP の推奨に従い、<code class="docutils literal notranslate"><span class="pre">ScryptPasswordHasher</span></code> の <code class="docutils literal notranslate"><span class="pre">parallelism</span></code> が 1 から 5 に増加しました。</p></li>
<li><p>新しい <a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.forms.AdminUserCreationForm" title="django.contrib.auth.forms.AdminUserCreationForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdminUserCreationForm</span></code></a> と、既存の <a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.forms.AdminPasswordChangeForm" title="django.contrib.auth.forms.AdminPasswordChangeForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdminPasswordChangeForm</span></code></a> は、フォームの保存時に使用不可のパスワードを設定することでパスワードベースの認証を無効化できるようになりました。この機能は、管理画面のユーザー作成ページやパスワード変更ページで利用可能です。</p></li>
<li><p><a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal notranslate"><span class="pre">login_required()</span></code></a>、<a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.decorators.permission_required" title="django.contrib.auth.decorators.permission_required"><code class="xref py py-func docutils literal notranslate"><span class="pre">permission_required()</span></code></a>、<a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.decorators.user_passes_test" title="django.contrib.auth.decorators.user_passes_test"><code class="xref py py-func docutils literal notranslate"><span class="pre">user_passes_test()</span></code></a> デコレータが、非同期ビュー関数のラッピングをサポートするようになりました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ReadOnlyPasswordHashWidget</span></code> に、ユーザーパスワードのリセットボタンが含まれるようになりました。このボタンは、以前に <code class="docutils literal notranslate"><span class="pre">ReadOnlyPasswordHashField</span></code> のヘルプテキストに埋め込まれていたリンクを置き換えます。これにより、<a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.forms.UserChangeForm" title="django.contrib.auth.forms.UserChangeForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserChangeForm</span></code></a> の全体的なアクセシビリティが向上します。</p></li>
</ul>
</section>
<section id="s-django-contrib-gis">
<span id="django-contrib-gis"></span><h4><a class="reference internal" href="../ref/contrib/gis/index.html#module-django.contrib.gis" title="django.contrib.gis: Geographic Information System (GIS) extensions for Django"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a><a class="headerlink" href="#django-contrib-gis" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>SpatiaLite 5.1 以降で <a class="reference internal" href="../ref/contrib/gis/functions.html#django.contrib.gis.db.models.functions.BoundingCircle" title="django.contrib.gis.db.models.functions.BoundingCircle"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoundingCircle</span></code></a> をサポートするようになりました。</p></li>
<li><p>MySQL 8.0.24 以降で <a class="reference internal" href="../ref/contrib/gis/geoquerysets.html#django.contrib.gis.db.models.Collect" title="django.contrib.gis.db.models.Collect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collect</span></code></a> をサポートするようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/geoip2.html#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeoIP2</span></code></a> が、<a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Address" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ipaddress.IPv4Address</span></code></a> または <a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv6Address" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ipaddress.IPv6Address</span></code></a> オブジェクトを使用してクエリできるようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/geoip2.html#django.contrib.gis.geoip2.GeoIP2.country" title="django.contrib.gis.geoip2.GeoIP2.country"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoIP2.country()</span></code></a> が <code class="docutils literal notranslate"><span class="pre">continent_code</span></code>、<code class="docutils literal notranslate"><span class="pre">continent_name</span></code>、<code class="docutils literal notranslate"><span class="pre">is_in_european_union</span></code> の値を公開するようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/geoip2.html#django.contrib.gis.geoip2.GeoIP2.city" title="django.contrib.gis.geoip2.GeoIP2.city"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoIP2.city()</span></code></a> は、<code class="docutils literal notranslate"><span class="pre">accuracy_radius</span></code> と <code class="docutils literal notranslate"><span class="pre">region_name</span></code> の値を新たに公開するようになりました。さらに、<code class="docutils literal notranslate"><span class="pre">dma_code</span></code> と <code class="docutils literal notranslate"><span class="pre">region</span></code> の値は、それぞれ <code class="docutils literal notranslate"><span class="pre">metro_code</span></code> と <code class="docutils literal notranslate"><span class="pre">region_code</span></code> として公開されるようになりましたが、後方互換性のために従来のキーも引き続き使用可能です。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/measure.html#django.contrib.gis.measure.Area" title="django.contrib.gis.measure.Area"><code class="xref py py-class docutils literal notranslate"><span class="pre">Area</span></code></a> は、<code class="docutils literal notranslate"><span class="pre">ha</span></code> 単位（ヘクタール）をサポートするようになりました。</p></li>
<li><p>新しい <a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry.is_3d" title="django.contrib.gis.gdal.OGRGeometry.is_3d"><code class="xref py py-attr docutils literal notranslate"><span class="pre">OGRGeometry.is_3d</span></code></a> 属性により、ジオメトリが <code class="docutils literal notranslate"><span class="pre">Z</span></code> 座標次元を持っているかどうかを確認できるようになりました。</p></li>
<li><p>新しい <a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry.set_3d" title="django.contrib.gis.gdal.OGRGeometry.set_3d"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OGRGeometry.set_3d()</span></code></a> メソッドにより、<code class="docutils literal notranslate"><span class="pre">Z</span></code> 座標次元の追加および削除が可能になりました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry" title="django.contrib.gis.gdal.OGRGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">OGRGeometry</span></code></a>、<a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.Point" title="django.contrib.gis.gdal.Point"><code class="xref py py-class docutils literal notranslate"><span class="pre">Point</span></code></a>、<a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.LineString" title="django.contrib.gis.gdal.LineString"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineString</span></code></a>、<a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.Polygon" title="django.contrib.gis.gdal.Polygon"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polygon</span></code></a>、および <a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.GeometryCollection" title="django.contrib.gis.gdal.GeometryCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryCollection</span></code></a> とそのサブクラスは、新しい <a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry.is_measured" title="django.contrib.gis.gdal.OGRGeometry.is_measured"><code class="xref py py-attr docutils literal notranslate"><span class="pre">OGRGeometry.is_measured</span></code></a> 属性、<code class="docutils literal notranslate"><span class="pre">m</span></code> プロパティ、および <a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry.set_measured" title="django.contrib.gis.gdal.OGRGeometry.set_measured"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OGRGeometry.set_measured()</span></code></a> メソッドを通じて測定ジオメトリ（Measured Geometries）をサポートするようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry.centroid" title="django.contrib.gis.gdal.OGRGeometry.centroid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">OGRGeometry.centroid</span></code></a> が、サポートされるすべてのジオメトリタイプで利用可能になりました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/functions.html#django.contrib.gis.db.models.functions.FromWKB" title="django.contrib.gis.db.models.functions.FromWKB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FromWKB()</span></code></a> および <a class="reference internal" href="../ref/contrib/gis/functions.html#django.contrib.gis.db.models.functions.FromWKT" title="django.contrib.gis.db.models.functions.FromWKT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FromWKT()</span></code></a> 関数が、オプションの <code class="docutils literal notranslate"><span class="pre">srid</span></code> 引数をサポートするようになりました（ただし、Oracle では無視されます）。</p></li>
</ul>
</section>
<section id="s-django-contrib-postgres">
<span id="django-contrib-postgres"></span><h4><a class="reference internal" href="../ref/contrib/postgres/index.html#module-django.contrib.postgres" title="django.contrib.postgres: PostgreSQL-specific fields and features"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.postgres</span></code></a><a class="headerlink" href="#django-contrib-postgres" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/contrib/postgres/indexes.html#django.contrib.postgres.indexes.BTreeIndex" title="django.contrib.postgres.indexes.BTreeIndex"><code class="xref py py-class docutils literal notranslate"><span class="pre">BTreeIndex</span></code></a> が新たに <code class="docutils literal notranslate"><span class="pre">deduplicate_items</span></code> パラメータをサポートするようになりました。</p></li>
</ul>
</section>
<section id="s-django-contrib-sessions">
<span id="django-contrib-sessions"></span><h4><a class="reference internal" href="../topics/http/sessions.html#module-django.contrib.sessions" title="django.contrib.sessions: Provides session management for Django projects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.sessions</span></code></a><a class="headerlink" href="#django-contrib-sessions" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../topics/http/sessions.html#django.contrib.sessions.backends.cached_db.SessionStore" title="django.contrib.sessions.backends.cached_db.SessionStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.sessions.backends.cached_db.SessionStore</span></code></a> は、キャッシュにセッション情報を保存する際に例外を処理するようになりました。新たに追加された <a class="reference internal" href="../ref/logging.html#django-contrib-sessions-logger"><span class="std std-ref">セッションロガー</span></a> を通じて、適切なエラーメッセージとそのトレースバックをログに記録します。</p></li>
<li><p><a class="reference internal" href="../topics/http/sessions.html#django.contrib.sessions.backends.base.SessionBase" title="django.contrib.sessions.backends.base.SessionBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.sessions.backends.base.SessionBase</span></code></a> およびすべての組み込みセッションエンジンが非同期APIを提供するようになりました。新しい非同期メソッドはすべて <code class="docutils literal notranslate"><span class="pre">a</span></code> を接頭辞に持つ名前で提供され、例えば <code class="docutils literal notranslate"><span class="pre">aget()</span></code>、<code class="docutils literal notranslate"><span class="pre">akeys()</span></code>、<code class="docutils literal notranslate"><span class="pre">acycle_key()</span></code> などがあります。</p></li>
</ul>
</section>
<section id="s-database-backends">
<span id="database-backends"></span><h4>データベースバックエンド<a class="headerlink" href="#database-backends" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;init_command&quot;</span></code> オプションが SQLite の <a class="reference internal" href="../ref/settings.html#std-setting-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a> でサポートされるようになり、接続時に設定する <a class="reference internal" href="../ref/databases.html#sqlite-init-command"><span class="std std-ref">PRAGMA オプション</span></a> を指定できるようになりました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transaction_mode&quot;</span></code> オプションが SQLite の <a class="reference internal" href="../ref/settings.html#std-setting-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a> でサポートされるようになり、<a class="reference internal" href="../ref/databases.html#sqlite-transaction-behavior"><span class="std std-ref">トランザクションの動作</span></a> を指定できるようになりました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;pool&quot;</span></code> オプションが PostgreSQL の <a class="reference internal" href="../ref/settings.html#std-setting-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a> でサポートされるようになり、<a class="reference internal" href="../ref/databases.html#postgresql-pool"><span class="std std-ref">接続プール</span></a> を利用できるようになりました。</p></li>
</ul>
</section>
<section id="s-error-reporting">
<span id="error-reporting"></span><h4>エラー報告<a class="headerlink" href="#error-reporting" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>アクセシビリティ向上のため、技術的な404および500エラーページに、ヘッダー、フッター、メインコンテンツ領域に対応するHTMLランドマーク要素が使用されるようになりました。</p></li>
</ul>
</section>
<section id="s-file-storage">
<span id="file-storage"></span><h4>ファイルストレージ<a class="headerlink" href="#file-storage" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/files/storage.html#django.core.files.storage.FileSystemStorage" title="django.core.files.storage.FileSystemStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileSystemStorage</span></code></a> の <a class="reference internal" href="../ref/files/storage.html#django.core.files.storage.FileSystemStorage.allow_overwrite" title="django.core.files.storage.FileSystemStorage.allow_overwrite"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allow_overwrite</span></code></a> パラメータにより、既存のファイルを上書きして新しいファイルを保存できるようになりました。</p></li>
</ul>
</section>
<section id="s-forms">
<span id="forms"></span><h4>フォーム<a class="headerlink" href="#forms" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>アクセシビリティを向上させ、スクリーンリーダーがフィールドセットとそのヘルプテキストを関連付けられるようにするため、フォームのフィールドセットに <code class="docutils literal notranslate"><span class="pre">aria-describedby</span></code> HTML属性が追加されました。</p></li>
</ul>
</section>
<section id="s-management-commands">
<span id="management-commands"></span><h4>管理コマンド<a class="headerlink" href="#management-commands" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/django-admin.html#django-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> コマンドが、各オペレーションの <a class="reference internal" href="../ref/migration-operations.html#django.db.migrations.operations.base.OperationCategory" title="django.db.migrations.operations.base.OperationCategory"><code class="xref py py-class docutils literal notranslate"><span class="pre">オペレーション・カテゴリ</span></code></a> を強調表示するために意味のある記号を表示するようになりました。</p></li>
</ul>
</section>
<section id="s-migrations">
<span id="migrations"></span><h4>マイグレーション<a class="headerlink" href="#migrations" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>新しい <code class="docutils literal notranslate"><span class="pre">Operation.category</span></code> 属性により、<a class="reference internal" href="../ref/django-admin.html#django-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> がオペレーションに対して意味のある記号を表示するために使用する <a class="reference internal" href="../ref/migration-operations.html#django.db.migrations.operations.base.OperationCategory" title="django.db.migrations.operations.base.OperationCategory"><code class="xref py py-class docutils literal notranslate"><span class="pre">オペレーション・カテゴリ</span></code></a> を指定できるようになりました。</p></li>
</ul>
</section>
<section id="s-models">
<span id="models"></span><h4>モデル<a class="headerlink" href="#models" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/models/querysets.html#django.db.models.query.QuerySet.explain" title="django.db.models.query.QuerySet.explain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuerySet.explain()</span></code></a> が PostgreSQL 16以降で <code class="docutils literal notranslate"><span class="pre">generic_plan</span></code> オプションをサポートするようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/models/expressions.html#django.db.models.expressions.RowRange" title="django.db.models.expressions.RowRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">RowRange</span></code></a> は、<code class="docutils literal notranslate"><span class="pre">start</span></code> 引数に正の整数、<code class="docutils literal notranslate"><span class="pre">end</span></code> 引数に負の整数を受け入れるようになりました。</p></li>
<li><p>新しい <code class="docutils literal notranslate"><span class="pre">exclusion</span></code> 引数が <a class="reference internal" href="../ref/models/expressions.html#django.db.models.expressions.RowRange" title="django.db.models.expressions.RowRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">RowRange</span></code></a> と <a class="reference internal" href="../ref/models/expressions.html#django.db.models.expressions.ValueRange" title="django.db.models.expressions.ValueRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueRange</span></code></a> に追加され、ウィンドウフレームから行、グループ、および同順位（タイ）を除外できるようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/models/querysets.html#django.db.models.query.QuerySet.order_by" title="django.db.models.query.QuerySet.order_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuerySet.order_by()</span></code></a> が、アノテーションのトランスフォーム、たとえば <code class="docutils literal notranslate"><span class="pre">JSONObject</span></code> のキーや <code class="docutils literal notranslate"><span class="pre">ArrayAgg</span></code> のインデックスなどによる並び替えをサポートするようになりました。</p></li>
<li><p><a class="reference internal" href="../ref/models/expressions.html#django.db.models.F" title="django.db.models.F"><code class="xref py py-class docutils literal notranslate"><span class="pre">F()</span></code></a> 式と <a class="reference internal" href="../ref/models/expressions.html#django.db.models.OuterRef" title="django.db.models.OuterRef"><code class="xref py py-class docutils literal notranslate"><span class="pre">OuterRef()</span></code></a> 式が、<a class="reference internal" href="../ref/models/fields.html#django.db.models.CharField" title="django.db.models.CharField"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharField</span></code></a>、<a class="reference internal" href="../ref/models/fields.html#django.db.models.EmailField" title="django.db.models.EmailField"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailField</span></code></a>、<a class="reference internal" href="../ref/models/fields.html#django.db.models.SlugField" title="django.db.models.SlugField"><code class="xref py py-class docutils literal notranslate"><span class="pre">SlugField</span></code></a>、<a class="reference internal" href="../ref/models/fields.html#django.db.models.URLField" title="django.db.models.URLField"><code class="xref py py-class docutils literal notranslate"><span class="pre">URLField</span></code></a>、<a class="reference internal" href="../ref/models/fields.html#django.db.models.TextField" title="django.db.models.TextField"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextField</span></code></a>、あるいは <a class="reference internal" href="../ref/contrib/postgres/fields.html#django.contrib.postgres.fields.ArrayField" title="django.contrib.postgres.fields.ArrayField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayField</span></code></a> を出力する場合、<a class="reference internal" href="../ref/models/expressions.html#slicing-using-f"><span class="std std-ref">スライス</span></a> が可能になりました。</p></li>
<li><p><a class="reference internal" href="../ref/models/instances.html#django.db.models.Model.refresh_from_db" title="django.db.models.Model.refresh_from_db"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.refresh_from_db()</span></code></a> と <a class="reference internal" href="../ref/models/instances.html#django.db.models.Model.arefresh_from_db" title="django.db.models.Model.arefresh_from_db"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.arefresh_from_db()</span></code></a> に新しく追加された <code class="docutils literal notranslate"><span class="pre">from_queryset</span></code> 引数を使用すれば、モデルの値を再読み込みするためのクエリセットをカスタマイズできます。これにより、再読み込み前に行をロックしたり、リレーション先のオブジェクトを取得したりすることが可能になります。</p></li>
<li><p>新しい <a class="reference internal" href="../ref/models/expressions.html#django.db.models.Expression.constraint_validation_compatible" title="django.db.models.Expression.constraint_validation_compatible"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Expression.constraint_validation_compatible</span></code></a> 属性を使用すると、制約の検証時にその式を無視するよう指定することができます。</p></li>
</ul>
</section>
<section id="s-templates">
<span id="templates"></span><h4>テンプレート<a class="headerlink" href="#templates" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>カスタムタグは、<code class="docutils literal notranslate"><span class="pre">Parser</span></code> オブジェクトに追加のデータを設定できるようになりました。このデータは <code class="docutils literal notranslate"><span class="pre">Template</span></code> インスタンス上で利用可能になります。このようなデータは、テンプレートローダーや他のテンプレートクライアントで使用できます。</p></li>
<li><p><a class="reference internal" href="../topics/checks.html#field-checking"><span class="std std-ref">テンプレートエンジン</span></a> は、チェックフレームワークに既に登録されている <code class="docutils literal notranslate"><span class="pre">check()</span></code> メソッドを実装するようになりました。</p></li>
</ul>
</section>
<section id="s-tests">
<span id="tests"></span><h4>テスト<a class="headerlink" href="#tests" title="Link to this heading">¶</a></h4>
<ul>
<li><p><a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertContains" title="django.test.SimpleTestCase.assertContains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertContains()</span></code></a>、<a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertNotContains" title="django.test.SimpleTestCase.assertNotContains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotContains()</span></code></a>、および <a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertInHTML" title="django.test.SimpleTestCase.assertInHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertInHTML()</span></code></a> は、アサーションエラーメッセージにヘイスタック（haystacks）を追加するようになりました。</p></li>
<li><p><a class="reference internal" href="../topics/testing/advanced.html#django.test.RequestFactory" title="django.test.RequestFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestFactory</span></code></a>、<a class="reference internal" href="../topics/testing/advanced.html#django.test.AsyncRequestFactory" title="django.test.AsyncRequestFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncRequestFactory</span></code></a>、<a class="reference internal" href="../topics/testing/tools.html#django.test.Client" title="django.test.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a>、および <a class="reference internal" href="../topics/testing/tools.html#django.test.AsyncClient" title="django.test.AsyncClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncClient</span></code></a> クラスは、新たに <code class="docutils literal notranslate"><span class="pre">query_params</span></code> パラメータをサポートしました。このパラメータは、クエリ文字列のキーと値を含む辞書を受け付けます。これにより、任意のHTTPメソッドに対してクエリ文字列を簡単に設定できるようになりました。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/items/1&quot;</span><span class="p">,</span> <span class="n">query_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;delete&quot;</span><span class="p">})</span>
<span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/items/1&quot;</span><span class="p">,</span> <span class="n">query_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;delete&quot;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p>新しい <a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertNotInHTML" title="django.test.SimpleTestCase.assertNotInHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SimpleTestCase.assertNotInHTML()</span></code></a> アサーションにより、指定されたHTMLヘイスタック内に特定のHTMLフラグメントが含まれていないことをテストできるようになりました。</p></li>
<li><p>テストの独立性を確保するため、<a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase" title="django.test.SimpleTestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleTestCase</span></code></a> 内でスレッド内のデータベース接続が許可されなくなりました。</p></li>
</ul>
</section>
<section id="s-validators">
<span id="validators"></span><h4>バリデータ<a class="headerlink" href="#validators" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>新しい <a class="reference internal" href="../ref/validators.html#django.core.validators.DomainNameValidator" title="django.core.validators.DomainNameValidator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainNameValidator</span></code></a> は、国際化ドメイン名を含むドメイン名を検証します。また、新しい <a class="reference internal" href="../ref/validators.html#django.core.validators.validate_domain_name" title="django.core.validators.validate_domain_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate_domain_name()</span></code></a> 関数は、<a class="reference internal" href="../ref/validators.html#django.core.validators.DomainNameValidator" title="django.core.validators.DomainNameValidator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainNameValidator</span></code></a> のインスタンスを返します。</p></li>
</ul>
</section>
</section>
</section>
<section id="s-backwards-incompatible-changes-in-5-1">
<span id="s-backwards-incompatible-5-1"></span><span id="backwards-incompatible-changes-in-5-1"></span><span id="backwards-incompatible-5-1"></span><h2>5.1 における後方互換性のない変更<a class="headerlink" href="#backwards-incompatible-changes-in-5-1" title="Link to this heading">¶</a></h2>
<section id="s-id1">
<span id="id1"></span><h3><a class="reference internal" href="../ref/contrib/gis/index.html#module-django.contrib.gis" title="django.contrib.gis: Geographic Information System (GIS) extensions for Django"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>PostGIS 2.5 に対するサポートが削除されました。</p></li>
<li><p>PROJ &lt; 6 のサポートが削除されました。</p></li>
<li><p>GDAL 2.4 のサポートが削除されました。</p></li>
<li><p><a class="reference internal" href="../ref/contrib/gis/geoip2.html#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeoIP2</span></code></a> は、ディレクトリパスが指定された場合に、これまでのように都市データベースと国データベースの両方を開くことはなくなりました。代わりに、都市データベースが利用可能であればそちらを優先します。国データベースは都市データベースのサブセットであり、通常は両方を使用する必要はありません。同じディレクトリ内で国データベースを使用する必要がある場合は、コンストラクタに国データベースのパスを明示的に渡してください。</p></li>
</ul>
</section>
<section id="s-dropped-support-for-mariadb-10-4">
<span id="dropped-support-for-mariadb-10-4"></span><h3>MariaDB 10.4 のサポートを終了しました<a class="headerlink" href="#dropped-support-for-mariadb-10-4" title="Link to this heading">¶</a></h3>
<p>MariaDB 10.4のアップストリームサポートは2024年6月に終了します。Django 5.1はMariaDB 10.5以降をサポートします。</p>
</section>
<section id="s-dropped-support-for-postgresql-12">
<span id="dropped-support-for-postgresql-12"></span><h3>PostgreSQL 12 のサポートを終了しました<a class="headerlink" href="#dropped-support-for-postgresql-12" title="Link to this heading">¶</a></h3>
<p>PostgreSQL 12 のアップストリーム サポートは 2024 年 11 月に終了します。Django 5.1 は PostgreSQL 13 以降をサポートします。</p>
</section>
<section id="s-miscellaneous">
<span id="miscellaneous"></span><h3>その他<a class="headerlink" href="#miscellaneous" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>アクセシビリティを向上させるために、admin サイトの changelist フィルタを <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;</span></code> タグではなく <code class="docutils literal notranslate"><span class="pre">&lt;nav&gt;</span></code> タグでレンダリングするようになりました。</p></li>
<li><p>アクセシビリティを向上させるために、admin サイトの footer を <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;</span></code> タグではなく <code class="docutils literal notranslate"><span class="pre">&lt;footer&gt;</span></code> タグでレンダリングするようになり、さらに <code class="docutils literal notranslate"><span class="pre">&lt;div</span> <span class="pre">id=&quot;main&quot;&gt;</span></code> 要素の下に移動しました。</p></li>
<li><p>アクセシビリティを向上させるため、名前付きのフィールドセットで <code class="docutils literal notranslate"><span class="pre">collapse</span></code> クラスを使用する <a class="reference internal" href="../ref/contrib/admin/index.html#django.contrib.admin.ModelAdmin.fieldsets" title="django.contrib.admin.ModelAdmin.fieldsets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelAdmin.fieldsets</span></code></a> および <a class="reference internal" href="../ref/contrib/admin/index.html#django.contrib.admin.InlineModelAdmin" title="django.contrib.admin.InlineModelAdmin"><code class="xref py py-attr docutils literal notranslate"><span class="pre">InlineModelAdmin.fieldsets</span></code></a> に関連付けられた展開可能なウィジェットが、 <code class="docutils literal notranslate"><span class="pre">&lt;details&gt;</span></code> および <code class="docutils literal notranslate"><span class="pre">&lt;summary&gt;</span></code> 要素を含むようになりました。</p></li>
<li><p>JavaScript ファイル <code class="docutils literal notranslate"><span class="pre">collapse.js</span></code> は、Django admin サイトでは不要になったので削除されました。</p></li>
<li><p><a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertURLEqual" title="django.test.SimpleTestCase.assertURLEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SimpleTestCase.assertURLEqual()</span></code></a> と <a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertInHTML" title="django.test.SimpleTestCase.assertInHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertInHTML()</span></code></a> は <code class="docutils literal notranslate"><span class="pre">&quot;:</span> <span class="pre">&quot;</span></code> を <code class="docutils literal notranslate"><span class="pre">msg_prefix</span></code> に追加します。これにより、他のアサーションの振る舞いと一致するようになります。</p></li>
<li><p><a class="reference internal" href="../ref/templates/builtins.html#std-templatefilter-truncatechars_html"><code class="xref std std-tfilter docutils literal notranslate"><span class="pre">truncatechars_html</span></code></a> および <a class="reference internal" href="../ref/templates/builtins.html#std-templatefilter-truncatewords_html"><code class="xref std std-tfilter docutils literal notranslate"><span class="pre">truncatewords_html</span></code></a> テンプレートフィルタで使用される <code class="docutils literal notranslate"><span class="pre">django.utils.text.Truncator</span></code> が、<a class="reference external" href="https://docs.python.org/3/library/html.parser.html#html.parser.HTMLParser" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">html.parser.HTMLParser</span></code></a> サブクラスを使用するようになりました。これにより、動作がより堅牢かつ高速になりますが、出力にわずかな違いが生じる可能性があります。</p></li>
<li><p>ドキュメント化されていなかった <code class="docutils literal notranslate"><span class="pre">django.urls.converters.get_converter()</span></code> 関数が削除されました。</p></li>
<li><p>SQLite の最小サポートバージョンが 3.27.0 から 3.31.0 に引き上げられました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> なしでファイルを保存した場合に、<a class="reference internal" href="../ref/models/fields.html#django.db.models.FileField" title="django.db.models.FileField"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileField</span></code></a> が <a class="reference internal" href="../ref/exceptions.html#django.core.exceptions.FieldError" title="django.core.exceptions.FieldError"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldError</span></code></a> を発生させるようになりました。</p></li>
<li><p>画像をストレージに保存した後に <code class="docutils literal notranslate"><span class="pre">ImageField.update_dimension_fields(force=True)</span></code> が呼び出されなくなりました。ストレージバックエンドが画像をリサイズする場合、<code class="docutils literal notranslate"><span class="pre">width_field</span></code> と <code class="docutils literal notranslate"><span class="pre">height_field</span></code> が実際の画像の幅と高さと一致しなくなります。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">asgiref</span></code> の最小サポートバージョンが 3.7.0 から 3.8.1 に引き上げられました。</p></li>
</ul>
</section>
</section>
<section id="s-features-deprecated-in-5-1">
<span id="s-deprecated-features-5-1"></span><span id="features-deprecated-in-5-1"></span><span id="deprecated-features-5-1"></span><h2>5.1 で非推奨となった機能<a class="headerlink" href="#features-deprecated-in-5-1" title="Link to this heading">¶</a></h2>
<section id="s-id2">
<span id="id2"></span><h3>その他<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ModelAdmin.log_deletion()</span></code> メソッドと <code class="docutils literal notranslate"><span class="pre">LogEntryManager.log_action()</span></code> メソッドは非推奨になりました。サブクラスは代わりに <code class="docutils literal notranslate"><span class="pre">ModelAdmin.log_deletions()</span></code> と <code class="docutils literal notranslate"><span class="pre">LogEntryManager.log_actions()</span></code> を実装する必要があります。</p></li>
<li><p>文書化されていない <code class="docutils literal notranslate"><span class="pre">django.utils.itercompat.is_iterable()</span></code> 関数と <code class="docutils literal notranslate"><span class="pre">django.utils.itercompat</span></code> モジュールが非推奨になりました。代わりに <code class="docutils literal notranslate"><span class="pre">isinstance(...,</span> <span class="pre">collections.abc.Iterable)</span></code> を使用してください。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">django.contrib.gis.geoip2.GeoIP2.coords()</span></code> メソッドは非推奨になりました。代わりに <code class="docutils literal notranslate"><span class="pre">django.contrib.gis.geoip2.GeoIP2.lon_lat()</span></code> を使用してください。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">django.contrib.gis.geoip2.GeoIP2.open()</span></code> メソッドは非推奨になりました。代わりに <a class="reference internal" href="../ref/contrib/gis/geoip2.html#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeoIP2</span></code></a> コンストラクタを使用してください。</p></li>
<li><p><a class="reference internal" href="../ref/models/instances.html#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.save()</span></code></a> および <a class="reference internal" href="../ref/models/instances.html#django.db.models.Model.asave" title="django.db.models.Model.asave"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.asave()</span></code></a> への位置引数の引き渡しは非推奨となり、キーワードのみの引数が推奨されるようになりました。</p></li>
<li><p>設定 <code class="docutils literal notranslate"><span class="pre">django.contrib.gis.gdal.OGRGeometry.coord_dim</span></code> は非推奨になりました。代わりに <a class="reference internal" href="../ref/contrib/gis/gdal.html#django.contrib.gis.gdal.OGRGeometry.set_3d" title="django.contrib.gis.gdal.OGRGeometry.set_3d"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_3d()</span></code></a> を使用してください。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">django.urls.register_converter()</span></code> による既存のコンバータのオーバーライドは非推奨になりました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CheckConstraint</span></code> の <code class="docutils literal notranslate"><span class="pre">check</span></code> キーワード引数は非推奨となり、代わりに <code class="docutils literal notranslate"><span class="pre">condition</span></code> が推奨されるようになりました。</p></li>
<li><p>文書化されていない <a class="reference internal" href="../ref/files/storage.html#django.core.files.storage.FileSystemStorage" title="django.core.files.storage.FileSystemStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileSystemStorage</span></code></a> の <code class="docutils literal notranslate"><span class="pre">OS_OPEN_FLAGS</span></code> プロパティは非推奨となりました。ストレージ内のファイルを上書きできるようにするには、新しい <a class="reference internal" href="../ref/files/storage.html#django.core.files.storage.FileSystemStorage.allow_overwrite" title="django.core.files.storage.FileSystemStorage.allow_overwrite"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allow_overwrite</span></code></a> オプションを <code class="docutils literal notranslate"><span class="pre">True</span></code> に設定してください。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FieldCacheMixin</span></code> の <code class="docutils literal notranslate"><span class="pre">get_cache_name()</span></code> メソッドは非推奨となり、代わりに <code class="docutils literal notranslate"><span class="pre">cache_name</span></code> キャッシュプロパティが推奨されるようになりました。</p></li>
</ul>
</section>
</section>
<section id="s-features-removed-in-5-1">
<span id="features-removed-in-5-1"></span><h2>5.1 で削除された機能<a class="headerlink" href="#features-removed-in-5-1" title="Link to this heading">¶</a></h2>
<p>以下の機能は、非推奨サイクルの終わりに達したため、Django 5.1 で削除されます。</p>
<p>これらの変更の詳細、およびこれらの機能の使用を取り除く方法については、<a class="reference internal" href="4.2.html#deprecated-features-4-2"><span class="std std-ref">4.2 で非推奨となった機能</span></a> を参照してください。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BaseUserManager.make_random_password()</span></code> メソッドは削除されました。</p></li>
<li><p>モデルの <code class="docutils literal notranslate"><span class="pre">Meta.index_together</span></code> オプションは削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length_is</span></code> テンプレートフィルタは削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">django.contrib.auth.hashers.SHA1PasswordHasher</span></code>、<code class="docutils literal notranslate"><span class="pre">django.contrib.auth.hashers.UnsaltedSHA1PasswordHasher</span></code>、<code class="docutils literal notranslate"><span class="pre">django.contrib.auth.hashers.UnsaltedMD5PasswordHasher</span></code> は削除されました。</p></li>
<li><p>モデルの <code class="docutils literal notranslate"><span class="pre">django.contrib.postgres.fields.CICharField</span></code> 、 <code class="docutils literal notranslate"><span class="pre">django.contrib.postgres.fields.CIEmailField</span></code> 、<code class="docutils literal notranslate"><span class="pre">django.contrib.postgres.fields.CITextField</span></code> は、履歴マイグレーションにおけるサポートを除いて、削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">django.contrib.postgres.fields.CIText</span></code> ミックスインは削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BaseGeometryWidget</span></code> の <code class="docutils literal notranslate"><span class="pre">map_width</span></code> と <code class="docutils literal notranslate"><span class="pre">map_height</span></code> 属性は削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleTestCase.assertFormsetError()</span></code> メソッドは削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TransactionTestCase.assertQuerysetEqual()</span></code> メソッドは削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JSONField</span></code> と関連するルックアップや式に対して、エンコードされた JSON 文字列リテラルを渡すことはサポートされなくなりました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Signer</span></code> および <code class="docutils literal notranslate"><span class="pre">TimestampSigner</span></code> への位置引数の受け渡しのサポートが削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DEFAULT_FILE_STORAGE</span></code> と <code class="docutils literal notranslate"><span class="pre">STATICFILES_STORAGE</span></code> の設定は削除されました。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">django.core.files.storage.get_storage_class()</span></code> 関数は削除されました。</p></li>
</ul>
</section>
</section>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="#">Django 5.1 リリースノート</a><ul>
<li><a class="reference internal" href="#python-compatibility">Python バージョン間の互換性</a></li>
<li><a class="reference internal" href="#what-s-new-in-django-5-1">Django 5.1 の新機能</a><ul>
<li><a class="reference internal" href="#querystring-template-tag"><code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">querystring</span> <span class="pre">%}</span></code> テンプレートタグ</a></li>
<li><a class="reference internal" href="#postgresql-connection-pools">PostgreSQL の接続プール</a></li>
<li><a class="reference internal" href="#middleware-to-require-authentication-by-default">デフォルトで認証を要求するミドルウェア</a></li>
<li><a class="reference internal" href="#minor-features">マイナーな機能</a><ul>
<li><a class="reference internal" href="#django-contrib-admin"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.admin</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-auth"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.auth</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-gis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-postgres"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.postgres</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-sessions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.sessions</span></code></a></li>
<li><a class="reference internal" href="#database-backends">データベースバックエンド</a></li>
<li><a class="reference internal" href="#error-reporting">エラー報告</a></li>
<li><a class="reference internal" href="#file-storage">ファイルストレージ</a></li>
<li><a class="reference internal" href="#forms">フォーム</a></li>
<li><a class="reference internal" href="#management-commands">管理コマンド</a></li>
<li><a class="reference internal" href="#migrations">マイグレーション</a></li>
<li><a class="reference internal" href="#models">モデル</a></li>
<li><a class="reference internal" href="#templates">テンプレート</a></li>
<li><a class="reference internal" href="#tests">テスト</a></li>
<li><a class="reference internal" href="#validators">バリデータ</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-incompatible-changes-in-5-1">5.1 における後方互換性のない変更</a><ul>
<li><a class="reference internal" href="#id1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a></li>
<li><a class="reference internal" href="#dropped-support-for-mariadb-10-4">MariaDB 10.4 のサポートを終了しました</a></li>
<li><a class="reference internal" href="#dropped-support-for-postgresql-12">PostgreSQL 12 のサポートを終了しました</a></li>
<li><a class="reference internal" href="#miscellaneous">その他</a></li>
</ul>
</li>
<li><a class="reference internal" href="#features-deprecated-in-5-1">5.1 で非推奨となった機能</a><ul>
<li><a class="reference internal" href="#id2">その他</a></li>
</ul>
</li>
<li><a class="reference internal" href="#features-removed-in-5-1">5.1 で削除された機能</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="5.1.1.html"
                          title="前の章へ">Django 5.1.1 リリースノート</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="5.0.12.html"
                          title="次の章へ">Django 5.0.12 release notes</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/releases/5.1.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">1月 22, 2025</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="5.1.1.html" title="Django 5.1.1 リリースノート">previous</a>
     |
    <a href="index.html" title="リリースノート" accesskey="U">up</a>
   |
    <a href="5.0.12.html" title="Django 5.0.12 release notes">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>