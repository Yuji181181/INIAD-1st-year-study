<!DOCTYPE html>

<html lang="ja" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GIS QuerySet API リファレンス &#8212; Django 5.1.6.dev20250122212402 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=34bb78ad" />
    <link rel="stylesheet" type="text/css" href="../../../_static/default.css?v=bf4d74af" />
    <script src="../../../_static/documentation_options.js?v=d2885b0a"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/translations.js?v=4755f45a"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="検索" href="../../../search.html" />
    <link rel="next" title="地理情報データベース関数" href="functions.html" />
    <link rel="prev" title="GeoDjango フォーム API" href="forms-api.html" />



 
<script src="../../../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../../../index.html">Django 5.1.6.dev20250122212402 ドキュメント</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../../../index.html">Home</a>  |
        <a title="Table of contents" href="../../../contents.html">Table of contents</a>  |
        <a title="Global index" href="../../../genindex.html">Index</a>  |
        <a title="Module index" href="../../../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="forms-api.html" title="GeoDjango フォーム API">previous</a>
     |
    <a href="../../index.html" title="API リファレンス" accesskey="U">up</a>
   |
    <a href="functions.html" title="地理情報データベース関数">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="ref-contrib-gis-geoquerysets">
            
  <section id="s-gis-queryset-api-reference">
<span id="gis-queryset-api-reference"></span><h1>GIS QuerySet API リファレンス<a class="headerlink" href="#gis-queryset-api-reference" title="Link to this heading">¶</a></h1>
<section id="s-spatial-lookups">
<span id="s-id1"></span><span id="spatial-lookups"></span><span id="id1"></span><h2>空間のルックアップ (Spatial Lookup)<a class="headerlink" href="#spatial-lookups" title="Link to this heading">¶</a></h2>
<p>このセクションの空間ルックアップは <a class="reference internal" href="model-api.html#django.contrib.gis.db.models.GeometryField" title="django.contrib.gis.db.models.GeometryField"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryField</span></code></a> と <a class="reference internal" href="model-api.html#django.contrib.gis.db.models.RasterField" title="django.contrib.gis.db.models.RasterField"><code class="xref py py-class docutils literal notranslate"><span class="pre">RasterField</span></code></a> 用です。</p>
<p>導入については、 <a class="reference internal" href="db-api.html#spatial-lookups-intro"><span class="std std-ref">空間ルックアップの概要</span></a> を参照してください。特定の空間バックエンドと互換性のあるルックアップの概要については、 <a class="reference internal" href="db-api.html#spatial-lookup-compatibility"><span class="std std-ref">空間ルックアップの互換表</span></a> を参照してください。</p>
<section id="s-lookups-with-rasters">
<span id="lookups-with-rasters"></span><h3>ラスターのルックアップ<a class="headerlink" href="#lookups-with-rasters" title="Link to this heading">¶</a></h3>
<p>以下のリファレンスにあるすべての例は地理情報フィールドおよび入力に対して提供されていますが、ルックアップはラスタの両側で同じように使用できます。ルックアップがラスター入力をサポートしていない場合、入力は <a class="reference external" href="https://postgis.net/docs/RT_ST_Polygon.html">ST_Polygon</a> 関数を使用して必要に応じて自動的にジオメトリに変換されます。 <a class="reference internal" href="db-api.html#spatial-lookup-raster"><span class="std std-ref">ラスタルックアップの概要</span></a> も参照してください。</p>
<p>ルックアップで使用されるデータベース演算子は、以下の 3 つのカテゴリに分類できます:</p>
<ul class="simple">
<li><p>ネイティブラスターサポート (<code class="docutils literal notranslate"><span class="pre">N</span></code>): この演算子は、参照先としてラスターをネイティブに受け入れ、ラスター入力をジオメトリ入力と混在させることができます。</p></li>
<li><p>双方向ラスターサポート <code class="docutils literal notranslate"><span class="pre">B</span></code>: このオペレータは、ルックアップの両側がラスター入力を受け取る場合のみ、ラスターをサポートします。異なるルックアップの場合は、ラスターデータは自動的にジオメトリに変換されます。</p></li>
<li><p>ジオメトリ変換サポート <code class="docutils literal notranslate"><span class="pre">C</span></code> 。ルックアップはネイティブのラスターをサポートしていないため、すべてのラスターデータは自動的にジオメトリに変換されます。</p></li>
</ul>
<p>以下の例は、さまざまなタイプのラスターサポートにおけるルックアップに相当する SQL を示しています。同じパターンがすべての空間ルックアップに適用されます。</p>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>ケース</p></th>
<th class="head"><p>ルックアップ</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>N, B</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__contains=rst</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(rast,</span> <span class="pre">rst)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>N, B</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__1__contains=(rst,</span> <span class="pre">2)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(rast,</span> <span class="pre">1,</span> <span class="pre">rst,</span> <span class="pre">2)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>B, C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__contains=geom</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(ST_Polygon(rast),</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>B, C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__1__contains=geom</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(ST_Polygon(rast,</span> <span class="pre">1),</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>B, C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly__contains=rst</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(poly,</span> <span class="pre">ST_Polygon(rst))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>B, C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly__contains=(rst,</span> <span class="pre">1)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(poly,</span> <span class="pre">ST_Polygon(rst,</span> <span class="pre">1))</span></code></p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__crosses=rst</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(ST_Polygon(rast),</span> <span class="pre">ST_Polygon(rst))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__1__crosses=(rst,</span> <span class="pre">2)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(ST_Polygon(rast,</span> <span class="pre">1),</span> <span class="pre">ST_Polygon(rst,</span> <span class="pre">2))</span></code></p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rast__crosses=geom</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(ST_Polygon(rast),</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly__crosses=rst</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(poly,</span> <span class="pre">ST_Polygon(rst))</span></code></p></td>
</tr>
</tbody>
</table>
<p>ラスターを使った空間ルックアップは、PostGISバックエンド (この節ではPGRasterと表記) のみでサポートされています。</p>
</section>
<section id="s-bbcontains">
<span id="s-std-fieldlookup-bbcontains"></span><span id="bbcontains"></span><span id="std-fieldlookup-bbcontains"></span><h3><code class="docutils literal notranslate"><span class="pre">bbcontains</span></code><a class="headerlink" href="#bbcontains" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Contain.html">PostGIS</a>, MariaDB, MySQL, SpatiaLite, PGRaster (Native)</p>
<p>ジオメトリまたはラスタフィールドのバウンディングボックスが、ルックアップジオメトリのバウンディングボックスを完全に含むかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__bbcontains</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly</span> <span class="pre">~</span> <span class="pre">geom</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MBRContains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MBRContains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MbrContains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-bboverlaps">
<span id="s-std-fieldlookup-bboverlaps"></span><span id="bboverlaps"></span><span id="std-fieldlookup-bboverlaps"></span><h3><code class="docutils literal notranslate"><span class="pre">bboverlaps</span></code><a class="headerlink" href="#bboverlaps" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/geometry_overlaps.html">PostGIS</a>, MariaDB, MySQL, SpatiaLite, PGRaster (Native)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップジオメトリのバウンディングボックスと重なるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__bboverlaps</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly</span> <span class="pre">&amp;&amp;</span> <span class="pre">geom</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MBROverlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MBROverlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MbrOverlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-contained">
<span id="s-std-fieldlookup-contained"></span><span id="contained"></span><span id="std-fieldlookup-contained"></span><h3><code class="docutils literal notranslate"><span class="pre">contained</span></code><a class="headerlink" href="#contained" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Contained.html">PostGIS</a>, MariaDB, MySQL, SpatiaLite, PGRaster (Native)</p>
<p>ジオメトリフィールドのバウンディングボックスがルックアップジオメトリのバウンディングボックスに完全に含まれるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__contained</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly</span> <span class="pre">&#64;</span> <span class="pre">geom</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MBRWithin(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MBRWithin(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MbrWithin(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-contains">
<span id="s-std-fieldlookup-gis-contains"></span><span id="contains"></span><span id="std-fieldlookup-gis-contains"></span><h3><code class="docutils literal notranslate"><span class="pre">contains</span></code><a class="headerlink" href="#contains" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Contains.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドにルックアップ ジオメトリが含まれているかどうかを調べます。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__contains</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_CONTAINS(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Contains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Contains(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-contains-properly">
<span id="s-std-fieldlookup-contains_properly"></span><span id="contains-properly"></span><span id="std-fieldlookup-contains_properly"></span><h3><code class="docutils literal notranslate"><span class="pre">contains_properly</span></code><a class="headerlink" href="#contains-properly" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_ContainsProperly.html">PostGIS</a>, PGRaster (Bilateral)</p>
<p>ルックアップ ジオメトリがジオメトリ フィールドの内部と交差し、境界 (または外部) と交差しない場合に true を返します。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__contains_properly</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_ContainsProperly(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-coveredby">
<span id="s-std-fieldlookup-coveredby"></span><span id="coveredby"></span><span id="std-fieldlookup-coveredby"></span><h3><code class="docutils literal notranslate"><span class="pre">coveredby</span></code><a class="headerlink" href="#coveredby" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_CoveredBy.html">PostGIS</a>, Oracle, PGRaster (Bilateral), SpatiaLite</p>
<p>ジオメトリフィールドのどのポイントもルックアップジオメトリの外側にないかどうかをテストします。 <a class="footnote-reference brackets" href="#fncovers" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__coveredby</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_CoveredBy(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_COVEREDBY(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CoveredBy(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-covers">
<span id="s-std-fieldlookup-covers"></span><span id="covers"></span><span id="std-fieldlookup-covers"></span><h3><code class="docutils literal notranslate"><span class="pre">covers</span></code><a class="headerlink" href="#covers" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Covers.html">PostGIS</a>, Oracle, PGRaster (Bilateral), SpatiaLite</p>
<p>ルックアップされたジオメトリ内のどのポイントも、ジオメトリフィールドの外にないかどうかテストします。 <a class="footnote-reference brackets" href="#fncovers" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__covers</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Covers(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_COVERS(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Covers(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-crosses">
<span id="s-std-fieldlookup-crosses"></span><span id="crosses"></span><span id="std-fieldlookup-crosses"></span><h3><code class="docutils literal notranslate"><span class="pre">crosses</span></code><a class="headerlink" href="#crosses" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Crosses.html">PostGIS</a>, MariaDB, MySQL, SpatiaLite, PGRaster (Conversion)</p>
<p>ジオメトリフィールドがルックアップジオメトリと空間的に交差しているかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__crosses</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Crosses(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Crosses(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-disjoint">
<span id="s-std-fieldlookup-disjoint"></span><span id="disjoint"></span><span id="std-fieldlookup-disjoint"></span><h3><code class="docutils literal notranslate"><span class="pre">disjoint</span></code><a class="headerlink" href="#disjoint" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Disjoint.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドがルックアップジオメトリから空間的に分離しているかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__disjoint</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Disjoint(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_GEOM.RELATE(poly,</span> <span class="pre">'DISJOINT',</span> <span class="pre">geom,</span> <span class="pre">0.05)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Disjoint(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Disjoint(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Disjoint(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-equals">
<span id="s-std-fieldlookup-equals"></span><span id="equals"></span><span id="std-fieldlookup-equals"></span><h3><code class="docutils literal notranslate"><span class="pre">equals</span></code><a class="headerlink" href="#equals" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Equals.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Conversion)</p>
<p>ジオメトリフィールドがルックアップジオメトリと空間的に等しいかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__equals</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_EQUAL(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-exact-same-as">
<span id="s-std-fieldlookup-same_as"></span><span id="s-std-fieldlookup-exact-noindex"></span><span id="exact-same-as"></span><span id="std-fieldlookup-same_as"></span><span id="std-fieldlookup-exact-noindex"></span><h3><code class="docutils literal notranslate"><span class="pre">exact</span></code>, <code class="docutils literal notranslate"><span class="pre">same_as</span></code><a class="headerlink" href="#exact-same-as" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Same.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドがルックアップジオメトリと &quot;等しい&quot; かどうかをテストします。Oracle、MySQL、SpatiaLite では空間的な等しさをテストし、PostGIS ではバウンディングボックスの等しさをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">poly</span> <span class="pre">~=</span> <span class="pre">geom</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_EQUAL(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Equals(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-intersects">
<span id="s-std-fieldlookup-intersects"></span><span id="intersects"></span><span id="std-fieldlookup-intersects"></span><h3><code class="docutils literal notranslate"><span class="pre">intersects</span></code><a class="headerlink" href="#intersects" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Intersects.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドがルックアップジオメトリと空間的に交差しているかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__intersects</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Intersects(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_OVERLAPBDYINTERSECT(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Intersects(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Intersects(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Intersects(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-isempty">
<span id="s-std-fieldlookup-isempty"></span><span id="isempty"></span><span id="std-fieldlookup-isempty"></span><h3><code class="docutils literal notranslate"><span class="pre">isempty</span></code><a class="headerlink" href="#isempty" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_IsEmpty.html">PostGIS</a></p>
<p>ジオメトリが空かどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__isempty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="s-isvalid">
<span id="s-std-fieldlookup-isvalid"></span><span id="isvalid"></span><span id="std-fieldlookup-isvalid"></span><h3><code class="docutils literal notranslate"><span class="pre">isvalid</span></code><a class="headerlink" href="#isvalid" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: MySQL, <a class="reference external" href="https://postgis.net/docs/ST_IsValid.html">PostGIS</a>, Oracle, SpatiaLite</p>
<p>ジオメトリが有効かどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__isvalid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MySQL, PostGIS, SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_IsValid(poly)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT(poly,</span> <span class="pre">0.05)</span> <span class="pre">=</span> <span class="pre">'TRUE'</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-overlaps">
<span id="s-std-fieldlookup-overlaps"></span><span id="overlaps"></span><span id="std-fieldlookup-overlaps"></span><h3><code class="docutils literal notranslate"><span class="pre">overlaps</span></code><a class="headerlink" href="#overlaps" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Overlaps.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドがルックアップ ジオメトリと空間的に重なっているかどうかをテストします。</p>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Overlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_OVERLAPS(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Overlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Overlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Overlaps(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-relate">
<span id="s-std-fieldlookup-relate"></span><span id="relate"></span><span id="std-fieldlookup-relate"></span><h3><code class="docutils literal notranslate"><span class="pre">relate</span></code><a class="headerlink" href="#relate" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Relate.html">PostGIS</a>, MariaDB, Oracle, SpatiaLite, PGRaster (Conversion)</p>
<p>ジオメトリフィールドが指定されたパターンの値によって空間的に関連しているかをテストします。このルックアップには <code class="docutils literal notranslate"><span class="pre">(geom,</span> <span class="pre">pattern)</span></code> というタプルパラメータが必要であり、<code class="docutils literal notranslate"><span class="pre">pattern</span></code> の形式は空間バックエンドによって異なります。</p>
<section id="s-mariadb-postgis-and-spatialite">
<span id="mariadb-postgis-and-spatialite"></span><h4>MariaDB, PostGIS, SpatiaLite<a class="headerlink" href="#mariadb-postgis-and-spatialite" title="Link to this heading">¶</a></h4>
<p>これらの空間バックエンドでは、交差パターンは9文字からなる文字列で、ジオメトリフィールドとルックアップジオメトリの内部、境界、外部の交差を定義します。交差パターン行列では、次の文字のみを使用できます: <code class="docutils literal notranslate"><span class="pre">1</span></code>、<code class="docutils literal notranslate"><span class="pre">2</span></code>、<code class="docutils literal notranslate"><span class="pre">T</span></code>、<code class="docutils literal notranslate"><span class="pre">F</span></code>、または <code class="docutils literal notranslate"><span class="pre">*</span></code>。このルックアップタイプを使用すると、ユーザーはDE-9IMモデルに一致する特定のジオメトリのリレーションシップを「微調整」できます。 <a class="footnote-reference brackets" href="#fnde9im" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<p>ジオメトリの例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># A tuple lookup parameter is used to specify the geometry and</span>
<span class="c1"># the intersection pattern (the pattern here is for &#39;contains&#39;).</span>
<span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__relate</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="s2">&quot;T*T***FF*&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>PostGIS と MariaDB では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">ST_Relate</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;T*T***FF*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>SpatiaLite では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">Relate</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;T*T***FF*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>ラスターの例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__relate</span><span class="o">=</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;T*T***FF*&quot;</span><span class="p">))</span>
<span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">rast__2__relate</span><span class="o">=</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;T*T***FF*&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">ST_Relate</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">ST_Polygon</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;T*T***FF*&#39;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">ST_Relate</span><span class="p">(</span><span class="n">ST_Polygon</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ST_Polygon</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;T*T***FF*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="s-oracle">
<span id="oracle"></span><h4>Oracle<a class="headerlink" href="#oracle" title="Link to this heading">¶</a></h4>
<p>ここで、リレーションパターンは9つのリレーション文字列のうち少なくとも1つで構成されます: <code class="docutils literal notranslate"><span class="pre">TOUCH</span></code>, <code class="docutils literal notranslate"><span class="pre">OVERLAPBDYDISJOINT</span></code>, <code class="docutils literal notranslate"><span class="pre">OVERLAPBDYINTERSECT</span></code>, <code class="docutils literal notranslate"><span class="pre">EQUAL</span></code>, <code class="docutils literal notranslate"><span class="pre">INSIDE</span></code>, <code class="docutils literal notranslate"><span class="pre">COVEREDBY</span></code>, <code class="docutils literal notranslate"><span class="pre">CONTAINS</span></code>, <code class="docutils literal notranslate"><span class="pre">COVERS</span></code>, <code class="docutils literal notranslate"><span class="pre">ON</span></code>, <code class="docutils literal notranslate"><span class="pre">ANYINTERACT</span></code> 。複数の文字列を論理論理演算子 OR で結合することもできます。 <a class="footnote-reference brackets" href="#fnsdorelate" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> リレーション文字列は大文字小文字を区別しません。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__relate</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="s2">&quot;anyinteract&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Oracle では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">SDO_RELATE</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;anyinteract&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="s-touches">
<span id="s-std-fieldlookup-touches"></span><span id="touches"></span><span id="std-fieldlookup-touches"></span><h3><code class="docutils literal notranslate"><span class="pre">touches</span></code><a class="headerlink" href="#touches" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Touches.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite</p>
<p>ジオメトリ フィールドがルックアップ ジオメトリに空間的に接しているかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__touches</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Touches(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Touches(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Touches(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_TOUCH(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Touches(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-within">
<span id="s-std-fieldlookup-within"></span><span id="within"></span><span id="std-fieldlookup-within"></span><h3><code class="docutils literal notranslate"><span class="pre">within</span></code><a class="headerlink" href="#within" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Within.html">PostGIS</a>, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドが空間的にルックアップジオメトリ内にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__within</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Within(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Within(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Within(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_INSIDE(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Within(poly,</span> <span class="pre">geom)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-left">
<span id="s-std-fieldlookup-left"></span><span id="left"></span><span id="std-fieldlookup-left"></span><h3><code class="docutils literal notranslate"><span class="pre">left</span></code><a class="headerlink" href="#left" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Left.html">PostGIS</a>, PGRaster (Conversion)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップ ジオメトリのバウンディングボックスよりも厳密に左側にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__left</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-right">
<span id="s-std-fieldlookup-right"></span><span id="right"></span><span id="std-fieldlookup-right"></span><h3><code class="docutils literal notranslate"><span class="pre">right</span></code><a class="headerlink" href="#right" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Right.html">PostGIS</a>, PGRaster (Conversion)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップ ジオメトリのバウンディングボックスの厳密に右側にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__right</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-overlaps-left">
<span id="s-std-fieldlookup-overlaps_left"></span><span id="overlaps-left"></span><span id="std-fieldlookup-overlaps_left"></span><h3><code class="docutils literal notranslate"><span class="pre">overlaps_left</span></code><a class="headerlink" href="#overlaps-left" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Overleft.html">PostGIS</a>, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップ ジオメトリのバウンディングボックスと重なるか、または左にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__overlaps_left</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">&amp;&lt;</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-overlaps-right">
<span id="s-std-fieldlookup-overlaps_right"></span><span id="overlaps-right"></span><span id="std-fieldlookup-overlaps_right"></span><h3><code class="docutils literal notranslate"><span class="pre">overlaps_right</span></code><a class="headerlink" href="#overlaps-right" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Overright.html">PostGIS</a>, PGRaster (Bilateral)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップ ジオメトリのバウンディングボックスと重なっているか、または右側にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__overlaps_right</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">&amp;&gt;</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-overlaps-above">
<span id="s-std-fieldlookup-overlaps_above"></span><span id="overlaps-above"></span><span id="std-fieldlookup-overlaps_above"></span><h3><code class="docutils literal notranslate"><span class="pre">overlaps_above</span></code><a class="headerlink" href="#overlaps-above" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Overabove.html">PostGIS</a>, PGRaster (Conversion)</p>
<p>ジオメトリフィールドのバウンディングボックスがルックアップジオメトリのバウンディングボックスと重なっているか、または上にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__overlaps_above</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">|&amp;&gt;</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-overlaps-below">
<span id="s-std-fieldlookup-overlaps_below"></span><span id="overlaps-below"></span><span id="std-fieldlookup-overlaps_below"></span><h3><code class="docutils literal notranslate"><span class="pre">overlaps_below</span></code><a class="headerlink" href="#overlaps-below" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Overbelow.html">PostGIS</a>, PGRaster (Conversion)</p>
<p>ジオメトリフィールドのバウンディングボックスがルックアップジオメトリのバウンディングボックスと重なっているか、または下にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__overlaps_below</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">&amp;&lt;|</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-strictly-above">
<span id="s-std-fieldlookup-strictly_above"></span><span id="strictly-above"></span><span id="std-fieldlookup-strictly_above"></span><h3><code class="docutils literal notranslate"><span class="pre">strictly_above</span></code><a class="headerlink" href="#strictly-above" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Above.html">PostGIS</a>, PGRaster (Conversion)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップジオメトリのバウンディングボックスの厳密に上にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__strictly_above</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">|&gt;&gt;</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
<section id="s-strictly-below">
<span id="s-std-fieldlookup-strictly_below"></span><span id="strictly-below"></span><span id="std-fieldlookup-strictly_below"></span><h3><code class="docutils literal notranslate"><span class="pre">strictly_below</span></code><a class="headerlink" href="#strictly-below" title="Link to this heading">¶</a></h3>
<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Geometry_Below.html">PostGIS</a>, PGRaster (Conversion)</p>
<p>ジオメトリフィールドのバウンディングボックスが、ルックアップジオメトリのバウンディングボックスの厳密に下にあるかどうかをテストします。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__strictly_below</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS では下記の SQL と同等です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">&lt;&lt;|</span><span class="w"> </span><span class="n">geom</span>
</pre></div>
</div>
</section>
</section>
<section id="s-distance-lookups">
<span id="s-id6"></span><span id="distance-lookups"></span><span id="id6"></span><h2>距離ルックアップ<a class="headerlink" href="#distance-lookups" title="Link to this heading">¶</a></h2>
<p><em>利用可能なDB</em>: PostGIS, Oracle, MariaDB, MySQL, SpatiaLite, PGRaster (Native)</p>
<p>距離クエリの概要については <a class="reference internal" href="db-api.html#distance-queries"><span class="std std-ref">距離クエリの概要</span></a> を参照してください。</p>
<p>距離ルックアップは次の形式を取ります:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;field&gt;__&lt;distance lookup&gt;=(&lt;geometry/raster&gt;, &lt;distance value&gt;[, &quot;spheroid&quot;])
&lt;field&gt;__&lt;distance lookup&gt;=(&lt;raster&gt;, &lt;band_index&gt;, &lt;distance value&gt;[, &quot;spheroid&quot;])
&lt;field&gt;__&lt;band_index&gt;__&lt;distance lookup&gt;=(&lt;raster&gt;, &lt;band_index&gt;, &lt;distance value&gt;[, &quot;spheroid&quot;])
</pre></div>
</div>
<p>距離ルックアップに渡される値はタプルであり、最初の2つの値は必須で、それぞれ、距離の計算対象のジオメトリと距離値 (フィールドの単位での数値、 <a class="reference internal" href="measure.html#django.contrib.gis.measure.Distance" title="django.contrib.gis.measure.Distance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distance</span></code></a> オブジェクト、または <a class="reference internal" href="../../models/expressions.html"><span class="doc">クエリ式</span></a>) です。ルックアップにバンドインデックスを渡すには、2番目のエントリがバンドインデックスである3値タプルを使用します。</p>
<p><a class="reference internal" href="#std-fieldlookup-dwithin"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">dwithin</span></code></a> を除くすべての距離ルックアップには、オプションの要素として <code class="docutils literal notranslate"><span class="pre">'spheroid'</span></code> を含めることができます。これにより、測地座標系を持つフィールドにおいてより精度の高い回転楕円体距離計算関数を使用できます。</p>
<p>PostgreSQLでは、 <code class="docutils literal notranslate"><span class="pre">'spheroid'</span></code> オプションは <a class="reference external" href="https://postgis.net/docs/ST_DistanceSphere.html">ST_DistanceSphere</a> の代わりに <a class="reference external" href="https://postgis.net/docs/ST_Distance_Spheroid.html">ST_DistanceSpheroid</a> を使用します。投影座標系では、より単純な <a class="reference external" href="https://postgis.net/docs/ST_Distance.html">ST_Distance</a> 関数を使用します。ラスタは回転楕円体ベースのルックアップ用にジオメトリに変換されます。</p>
<section id="s-distance-gt">
<span id="s-std-fieldlookup-distance_gt"></span><span id="distance-gt"></span><span id="std-fieldlookup-distance_gt"></span><h3><code class="docutils literal notranslate"><span class="pre">distance_gt</span></code><a class="headerlink" href="#distance-gt" title="Link to this heading">¶</a></h3>
<p>指定された距離値よりも、ルックアップジオメトリからジオメトリフィールドへの距離が大きいモデルを返します。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__distance_gt</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance/ST_Distance_Sphere(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_GEOM.SDO_DISTANCE(poly,</span> <span class="pre">geom,</span> <span class="pre">0.05)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-distance-gte">
<span id="s-std-fieldlookup-distance_gte"></span><span id="distance-gte"></span><span id="std-fieldlookup-distance_gte"></span><h3><code class="docutils literal notranslate"><span class="pre">distance_gte</span></code><a class="headerlink" href="#distance-gte" title="Link to this heading">¶</a></h3>
<p>ルックアップしたジオメトリからジオメトリフィールドまでの距離が、指定した距離の値以上であるモデルを返します。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__distance_gte</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance/ST_Distance_Sphere(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_GEOM.SDO_DISTANCE(poly,</span> <span class="pre">geom,</span> <span class="pre">0.05)</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-distance-lt">
<span id="s-std-fieldlookup-distance_lt"></span><span id="distance-lt"></span><span id="std-fieldlookup-distance_lt"></span><h3><code class="docutils literal notranslate"><span class="pre">distance_lt</span></code><a class="headerlink" href="#distance-lt" title="Link to this heading">¶</a></h3>
<p>ルックアップしたジオメトリからジオメトリフィールドまでの距離が、指定した距離の値よりも小さいモデルを返します。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__distance_lt</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance/ST_Distance_Sphere(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_GEOM.SDO_DISTANCE(poly,</span> <span class="pre">geom,</span> <span class="pre">0.05)</span> <span class="pre">&lt;</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;</span> <span class="pre">5</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-distance-lte">
<span id="s-std-fieldlookup-distance_lte"></span><span id="distance-lte"></span><span id="std-fieldlookup-distance_lte"></span><h3><code class="docutils literal notranslate"><span class="pre">distance_lte</span></code><a class="headerlink" href="#distance-lte" title="Link to this heading">¶</a></h3>
<p>ルックアップされたジオメトリからジオメトリフィールドまでの距離が、指定された距離の値以下であるモデルを返します。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__distance_lte</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance/ST_Distance_Sphere(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MariaDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_GEOM.SDO_DISTANCE(poly,</span> <span class="pre">geom,</span> <span class="pre">0.05)</span> <span class="pre">&lt;=</span> <span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Distance(poly,</span> <span class="pre">geom)</span> <span class="pre">&lt;=</span> <span class="pre">5</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-dwithin">
<span id="s-std-fieldlookup-dwithin"></span><span id="dwithin"></span><span id="std-fieldlookup-dwithin"></span><h3><code class="docutils literal notranslate"><span class="pre">dwithin</span></code><a class="headerlink" href="#dwithin" title="Link to this heading">¶</a></h3>
<p>ルックアップしたジオメトリからジオメトリフィールドまでの距離が、指定した距離以内のモデルを返します。 <a class="reference internal" href="measure.html#django.contrib.gis.measure.Distance" title="django.contrib.gis.measure.Distance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distance</span></code></a> オブジェクトを指定できるのは、対象となるジオメトリが投影システムの場合のみであることに注意してください。地理ジオメトリの場合は、ジオメトリフィールドの単位を使用する必要があります (例えば <code class="docutils literal notranslate"><span class="pre">WGS84</span></code> の場合は度)。</p>
<p>実装例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__dwithin</span><span class="o">=</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>バックエンド</p></th>
<th class="head"><p>等価なSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostGIS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ST_DWithin(poly,</span> <span class="pre">geom,</span> <span class="pre">5)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Oracle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SDO_WITHIN_DISTANCE(poly,</span> <span class="pre">geom,</span> <span class="pre">5)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>SpatiaLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PtDistWithin(poly,</span> <span class="pre">geom,</span> <span class="pre">5)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s-aggregate-functions">
<span id="s-gis-aggregation-functions"></span><span id="aggregate-functions"></span><span id="gis-aggregation-functions"></span><h3>集計関数<a class="headerlink" href="#aggregate-functions" title="Link to this heading">¶</a></h3>
<p>Django はいくつかの GIS 固有の集計関数を提供しています。これらの集計関数の使い方の詳細については、 <a class="reference internal" href="../../../topics/db/aggregation.html"><span class="doc">集計に関するトピックガイド</span></a> を参照してください。</p>
<table class="docutils">
<thead>
<tr class="row-odd"><th class="head"><p>キーワード引数</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code></p></td>
<td><p>このキーワードはOracle専用です。<code class="docutils literal notranslate"><span class="pre">SDOAGGRTYPE</span></code> プロシージャで使用される許容値のためのものです。詳細は <a class="reference external" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/spatl/spatial-concepts.html#GUID-CE10AB14-D5EA-43BA-A647-DAC9EEF41EE6">Oracle documentation</a> を参照してください。</p></td>
</tr>
</tbody>
</table>
<p>例:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.gis.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Extent</span><span class="p">,</span> <span class="n">Union</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WorldBorder</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">Extent</span><span class="p">(</span><span class="s2">&quot;mpoly&quot;</span><span class="p">),</span> <span class="n">Union</span><span class="p">(</span><span class="s2">&quot;mpoly&quot;</span><span class="p">))</span>
</pre></div>
</div>
<section id="s-collect">
<span id="collect"></span><h4><code class="docutils literal notranslate"><span class="pre">Collect</span></code><a class="headerlink" href="#collect" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.gis.db.models.Collect">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Collect</span></span>(<em class="sig-param"><span class="n"><span class="pre">geo_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/5.1.x/django/contrib/gis/db/models/aggregates.py#L61"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#django.contrib.gis.db.models.Collect" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>互換性</em>: <a class="reference external" href="https://postgis.net/docs/ST_Collect.html">PostGIS</a>、MySQL、SpatiaLite</p>
<p>ジオメトリ列から <code class="docutils literal notranslate"><span class="pre">GEOMETRYCOLLECTION</span></code> または <code class="docutils literal notranslate"><span class="pre">MULTI</span></code> ジオメトリオブジェクトを返します。これは <a class="reference internal" href="#django.contrib.gis.db.models.Union" title="django.contrib.gis.db.models.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">Union</span></code></a> 集計の簡略版に似ていますが、ジオメトリをコレクションまたはマルチオブジェクトにまとめ、境界の解消を気にしないため、ユニオンを実行するよりも数桁高速です。</p>
<div class="versionchanged">
<span class="title">Changed in Django 5.0:</span> <p><code class="docutils literal notranslate"><span class="pre">filter</span></code> 引数のサポートが追加されました。</p>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 5.1:</span> <p>MySQL 8.0.24以降のサポートが追加されました。</p>
</div>
</section>
<section id="s-extent">
<span id="extent"></span><h4><code class="docutils literal notranslate"><span class="pre">Extent</span></code><a class="headerlink" href="#extent" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.gis.db.models.Extent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Extent</span></span>(<em class="sig-param"><span class="n"><span class="pre">geo_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/5.1.x/django/contrib/gis/db/models/aggregates.py#L66"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#django.contrib.gis.db.models.Extent" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Extent.html">PostGIS</a>, Oracle, SpatiaLite</p>
<p><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> 内のすべての <code class="docutils literal notranslate"><span class="pre">geo_field</span></code> の範囲を表す、左下の座標と右上の座標からなる4値タプルを返します。</p>
<p>例:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span> <span class="o">=</span> <span class="n">City</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__in</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Houston&quot;</span><span class="p">,</span> <span class="s2">&quot;Dallas&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">Extent</span><span class="p">(</span><span class="s2">&quot;poly&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">qs</span><span class="p">[</span><span class="s2">&quot;poly__extent&quot;</span><span class="p">])</span>
<span class="go">(-96.8016128540039, 29.7633724212646, -95.3631439208984, 32.782058715820)</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 5.0:</span> <p><code class="docutils literal notranslate"><span class="pre">filter</span></code> 引数のサポートが追加されました。</p>
</div>
</section>
<section id="s-extent3d">
<span id="extent3d"></span><h4><code class="docutils literal notranslate"><span class="pre">Extent3D</span></code><a class="headerlink" href="#extent3d" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.gis.db.models.Extent3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Extent3D</span></span>(<em class="sig-param"><span class="n"><span class="pre">geo_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/5.1.x/django/contrib/gis/db/models/aggregates.py#L77"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#django.contrib.gis.db.models.Extent3D" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_3DExtent.html">PostGIS</a></p>
<p><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> 内のすべての <code class="docutils literal notranslate"><span class="pre">geo_field</span></code> の 3D 範囲を、左下の座標と右上の座標 (それぞれ x、y、z 座標を持つ) からなる 6 要素のタプルとして返します。</p>
<p>例:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span> <span class="o">=</span> <span class="n">City</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__in</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Houston&quot;</span><span class="p">,</span> <span class="s2">&quot;Dallas&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">Extent3D</span><span class="p">(</span><span class="s2">&quot;poly&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">qs</span><span class="p">[</span><span class="s2">&quot;poly__extent3d&quot;</span><span class="p">])</span>
<span class="go">(-96.8016128540039, 29.7633724212646, 0, -95.3631439208984, 32.782058715820, 0)</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 5.0:</span> <p><code class="docutils literal notranslate"><span class="pre">filter</span></code> 引数のサポートが追加されました。</p>
</div>
</section>
<section id="s-makeline">
<span id="makeline"></span><h4><code class="docutils literal notranslate"><span class="pre">MakeLine</span></code><a class="headerlink" href="#makeline" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.gis.db.models.MakeLine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MakeLine</span></span>(<em class="sig-param"><span class="n"><span class="pre">geo_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/5.1.x/django/contrib/gis/db/models/aggregates.py#L88"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#django.contrib.gis.db.models.MakeLine" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_MakeLine.html">PostGIS</a>, SpatiaLite</p>
<p><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> 内のポイントフィールドジオメトリから構築された <code class="docutils literal notranslate"><span class="pre">LineString</span></code> を返します。現在、クエリセットの順序は意味がありません。</p>
<p>例:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span> <span class="o">=</span> <span class="n">City</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__in</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Houston&quot;</span><span class="p">,</span> <span class="s2">&quot;Dallas&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">MakeLine</span><span class="p">(</span><span class="s2">&quot;poly&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">qs</span><span class="p">[</span><span class="s2">&quot;poly__makeline&quot;</span><span class="p">])</span>
<span class="go">LINESTRING (-95.3631510000000020 29.7633739999999989, -96.8016109999999941 32.7820570000000018)</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 5.0:</span> <p><code class="docutils literal notranslate"><span class="pre">filter</span></code> 引数のサポートが追加されました。</p>
</div>
</section>
<section id="s-union">
<span id="union"></span><h4><code class="docutils literal notranslate"><span class="pre">Union</span></code><a class="headerlink" href="#union" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.gis.db.models.Union">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Union</span></span>(<em class="sig-param"><span class="n"><span class="pre">geo_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/5.1.x/django/contrib/gis/db/models/aggregates.py#L93"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#django.contrib.gis.db.models.Union" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><em>利用可能なDB</em>: <a class="reference external" href="https://postgis.net/docs/ST_Union.html">PostGIS</a>, Oracle, SpatiaLite</p>
<p>このメソッドは、クエリセット内のすべてのジオメトリの結合を含む <a class="reference internal" href="geos.html#django.contrib.gis.geos.GEOSGeometry" title="django.contrib.gis.geos.GEOSGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">GEOSGeometry</span></code></a> オブジェクトを返します。大きなクエリセットでは、<code class="docutils literal notranslate"><span class="pre">Union</span></code> を使用すると処理が集中し、かなりの時間がかかる可能性があることに注意してください。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>もしこの方法を使った計算に時間がかかりすぎる場合は、代わりに <a class="reference internal" href="#django.contrib.gis.db.models.Collect" title="django.contrib.gis.db.models.Collect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collect</span></code></a> を使用することを検討してください。</p>
</div>
<p>例:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">Union</span><span class="p">(</span><span class="n">poly</span><span class="p">))</span>  <span class="c1"># This may take a long time.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">Zipcode</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">poly__within</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">Union</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  <span class="c1"># A more sensible approach.</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 5.0:</span> <p><code class="docutils literal notranslate"><span class="pre">filter</span></code> 引数のサポートが追加されました。</p>
</div>
<p class="rubric">脚注</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="fnde9im" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">1</a><span class="fn-bracket">]</span></span>
<p><em>参考</em> <a class="reference external" href="https://portal.ogc.org/files/?artifact_id=829">OpenGIS Simple Feature Specification For SQL</a>, at Ch. 2.1.13.2, p. 2-13 (The Dimensionally Extended Nine-Intersection Model).</p>
</aside>
<aside class="footnote brackets" id="fnsdorelate" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">2</a><span class="fn-bracket">]</span></span>
<p><em>参考</em> Oracle Spatial and Graph Developer's Guide の <a class="reference external" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/spatl/spatial-operators-reference.html#GUID-97C17C18-F05E-49B4-BE11-E89B972E2A02">SDO_RELATE documentation</a> 。</p>
</aside>
<aside class="footnote brackets" id="fncovers" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>この処理の説明については、PostGIS 開発者の Martin Davis による <a class="reference external" href="https://lin-ear-th-inking.blogspot.com/2007/06/subtleties-of-ogc-covers-spatial.html">Quirks of the &quot;Contains&quot; Spatial Predicate</a> を参照してください。</p>
</aside>
</aside>
</section>
</section>
</section>
</section>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../contents.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="#">GIS QuerySet API リファレンス</a><ul>
<li><a class="reference internal" href="#spatial-lookups">空間のルックアップ (Spatial Lookup)</a><ul>
<li><a class="reference internal" href="#lookups-with-rasters">ラスターのルックアップ</a></li>
<li><a class="reference internal" href="#bbcontains"><code class="docutils literal notranslate"><span class="pre">bbcontains</span></code></a></li>
<li><a class="reference internal" href="#bboverlaps"><code class="docutils literal notranslate"><span class="pre">bboverlaps</span></code></a></li>
<li><a class="reference internal" href="#contained"><code class="docutils literal notranslate"><span class="pre">contained</span></code></a></li>
<li><a class="reference internal" href="#contains"><code class="docutils literal notranslate"><span class="pre">contains</span></code></a></li>
<li><a class="reference internal" href="#contains-properly"><code class="docutils literal notranslate"><span class="pre">contains_properly</span></code></a></li>
<li><a class="reference internal" href="#coveredby"><code class="docutils literal notranslate"><span class="pre">coveredby</span></code></a></li>
<li><a class="reference internal" href="#covers"><code class="docutils literal notranslate"><span class="pre">covers</span></code></a></li>
<li><a class="reference internal" href="#crosses"><code class="docutils literal notranslate"><span class="pre">crosses</span></code></a></li>
<li><a class="reference internal" href="#disjoint"><code class="docutils literal notranslate"><span class="pre">disjoint</span></code></a></li>
<li><a class="reference internal" href="#equals"><code class="docutils literal notranslate"><span class="pre">equals</span></code></a></li>
<li><a class="reference internal" href="#exact-same-as"><code class="docutils literal notranslate"><span class="pre">exact</span></code>, <code class="docutils literal notranslate"><span class="pre">same_as</span></code></a></li>
<li><a class="reference internal" href="#intersects"><code class="docutils literal notranslate"><span class="pre">intersects</span></code></a></li>
<li><a class="reference internal" href="#isempty"><code class="docutils literal notranslate"><span class="pre">isempty</span></code></a></li>
<li><a class="reference internal" href="#isvalid"><code class="docutils literal notranslate"><span class="pre">isvalid</span></code></a></li>
<li><a class="reference internal" href="#overlaps"><code class="docutils literal notranslate"><span class="pre">overlaps</span></code></a></li>
<li><a class="reference internal" href="#relate"><code class="docutils literal notranslate"><span class="pre">relate</span></code></a><ul>
<li><a class="reference internal" href="#mariadb-postgis-and-spatialite">MariaDB, PostGIS, SpatiaLite</a></li>
<li><a class="reference internal" href="#oracle">Oracle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#touches"><code class="docutils literal notranslate"><span class="pre">touches</span></code></a></li>
<li><a class="reference internal" href="#within"><code class="docutils literal notranslate"><span class="pre">within</span></code></a></li>
<li><a class="reference internal" href="#left"><code class="docutils literal notranslate"><span class="pre">left</span></code></a></li>
<li><a class="reference internal" href="#right"><code class="docutils literal notranslate"><span class="pre">right</span></code></a></li>
<li><a class="reference internal" href="#overlaps-left"><code class="docutils literal notranslate"><span class="pre">overlaps_left</span></code></a></li>
<li><a class="reference internal" href="#overlaps-right"><code class="docutils literal notranslate"><span class="pre">overlaps_right</span></code></a></li>
<li><a class="reference internal" href="#overlaps-above"><code class="docutils literal notranslate"><span class="pre">overlaps_above</span></code></a></li>
<li><a class="reference internal" href="#overlaps-below"><code class="docutils literal notranslate"><span class="pre">overlaps_below</span></code></a></li>
<li><a class="reference internal" href="#strictly-above"><code class="docutils literal notranslate"><span class="pre">strictly_above</span></code></a></li>
<li><a class="reference internal" href="#strictly-below"><code class="docutils literal notranslate"><span class="pre">strictly_below</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#distance-lookups">距離ルックアップ</a><ul>
<li><a class="reference internal" href="#distance-gt"><code class="docutils literal notranslate"><span class="pre">distance_gt</span></code></a></li>
<li><a class="reference internal" href="#distance-gte"><code class="docutils literal notranslate"><span class="pre">distance_gte</span></code></a></li>
<li><a class="reference internal" href="#distance-lt"><code class="docutils literal notranslate"><span class="pre">distance_lt</span></code></a></li>
<li><a class="reference internal" href="#distance-lte"><code class="docutils literal notranslate"><span class="pre">distance_lte</span></code></a></li>
<li><a class="reference internal" href="#dwithin"><code class="docutils literal notranslate"><span class="pre">dwithin</span></code></a></li>
<li><a class="reference internal" href="#aggregate-functions">集計関数</a><ul>
<li><a class="reference internal" href="#collect"><code class="docutils literal notranslate"><span class="pre">Collect</span></code></a></li>
<li><a class="reference internal" href="#extent"><code class="docutils literal notranslate"><span class="pre">Extent</span></code></a></li>
<li><a class="reference internal" href="#extent3d"><code class="docutils literal notranslate"><span class="pre">Extent3D</span></code></a></li>
<li><a class="reference internal" href="#makeline"><code class="docutils literal notranslate"><span class="pre">MakeLine</span></code></a></li>
<li><a class="reference internal" href="#union"><code class="docutils literal notranslate"><span class="pre">Union</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="forms-api.html"
                          title="前の章へ">GeoDjango フォーム API</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="functions.html"
                          title="次の章へ">地理情報データベース関数</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/ref/contrib/gis/geoquerysets.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">1月 22, 2025</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="forms-api.html" title="GeoDjango フォーム API">previous</a>
     |
    <a href="../../index.html" title="API リファレンス" accesskey="U">up</a>
   |
    <a href="functions.html" title="地理情報データベース関数">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>